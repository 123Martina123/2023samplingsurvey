## 以下内容是邹欣写的
### 2.1简介

​       在记录联系中（Fellegi和Sunter，1969年;Herzog等人，2007年），也称为实体或共同参考决议（Christen，2012年），其目的是将记录（与相关观察结果）识别并合并到单独的文件中，它们对应于相同的实体（或单元）。除非存在允许精确匹配的唯一标识符，当链接的记录实际上并未引用同一实体，或者未能链接引用同一实体的记录时，链接错误是不可避免的。
$$
表2.1
\space \space 2011年英国人口普查汇总和患者等级链接\\
\begin{array}
{cll}
\hline
	类型  & 通过  & 链接数 & 错误链接率 \\
\hline
	确定性的 &1&30780660   & 0.00011 \\
	        &2&11733197   &0.00389 \\
	        &3&1513471    & 0.00561 \\
	        &4&2444838    & 0.00375\\
	        &5&1346432    &0.00748\\
	        &6&121483     &0.00886\\
	        &7&1007293    &0.00100\\
	        &8&825069     &0.01485\\
	        &9&35432      &0.00100\\
\hline
概率性的&1&511239&0.02948\\
       &2&298645&0.07165\\
\hline
全部的& & &50617759\\
\hline
\end{array}
$$
​       表2.1提供了国家统计局（ONS）开展的2011年英格兰人口普查和患者登记（C-PR)联系的汇总。详见Owen等。（2015）关于基本方法的一些相关方面。是一个过程中的每一个都使用匹配（或关键）变量的不同组合，包括姓名、出生日期、性别、邮政编码等。最后，大约300万人口普查记录没有与患者登记册链接，而所有链接的记录都不是真是匹配的，如在不同通过处的估计错误链接率（FLR）所指示的。

​      二级分析员如何根据C-PR关联数据进行有效分析？这是我们在这里考虑的问题。有两个条件有助于澄清二级分析师的立场。一方面，可以有把握地假设二级分析师不能直接访问所有关键变量和单独的数据文件，也没有复制实际链接程序的详细知识或工具。例如，姓名、出生日期和邮政编码都用于C-PR链接，但出于隐私保护，这些数据不太可能被发布给二级分析师。另一方面，还必须假设可以提供一些关于记录如何实际相互比较的非公开链接比较数据。这对于允许任何其他可能性而不是按原样分析链接数据集是必要的；例如，参见Gilbert等人（2017）关于用于数据链接的信息交换协议。例如，可以为一对链接记录分配一个分数，以反映它们在关键变量方面的一致性。

#### 2.1.1 相关工作

​       当涉及到由于链接误差传播不确定性的记录链接数据分析时，可以在文献中辨别出不同的方法。不幸的是，现有的方法都不能充分解决上述二次分析的问题。

​        几乎所有的频繁方法都是基于一个数据集中的记录的概率的链接模型。Scheuren和Winkler(1993,1997)、Lahir和larsen(2005)、Chambers(2009)、Chipperfield和Chambers(2015)使用Monte Carlo模拟两个数据集之间的一致模式和后续记录链接过程来估计链接模型。该方法仅限于能够访问所有关键变量和实际链接过程的人员。因此，二级分析师将不得不采用大大简化的假设，如分庭的可交换链接错误模型（2009年），或采用特别办法。例如，Hof和Zwinderman（2015）假设要链接的两个数据集中的每对记录独立贡献成对为伪似然。但目前还不清楚这种伪概率如何产生有效的推论。

​        对于贝叶斯框架下的记录链接和分析，可以参考Tancredi和Liseo（2011），Gutman等人（2013）、Sadinle（2014）和 Stoerts等人（2016）等。推理基于匹配数据集的后验分布。观察到的关键变量的建模方法，如Stoerts等人所述。（2016），建立在Copas和Hilton（1990）的撞中模式。然而，失真模型适用于次要分析人员无法访问的关键变量，除非在特殊情况下。将大量后验匹配数据集分发给二级分析师可能并不总是切实可行的，也不能像C-PR案例中那样扩展到大型数据集。

​      Goldstein等人(2012)应用多重插补，其中被接受为正确链接的单元具有完整的观察结果，而其他记录对应的单元被认为具有缺失的观察结果。Gutman等人（2015）采用不同的方法对链接的记录对进行乘法插补，无论它们是否为真匹配，其中假定未链接的真匹配随机丢失。应该注意的是，这些估算方法不受底层链接数据结构的限制。例如，链接的记录是否为真匹配将影响其他记录对是否可能为真匹配。这些插补方法中没有内置类似这样的限制。

####  2.1.2勘察情况

​      我们将在续集中研究三种不同的方法。我们在第2.3节考虑了感兴趣参数的最大似然估计（MLE）。这基于这样一个概念，即比较数据是根据概率模型产生的，包括可能导致链接误差的关键变量真实值的失真。然而，它将会被证明，基于"链接数据结构"（详见第2.2节）模型的MLE一般不简单。讨论涉及到从二元正态变量的破碎随机样本对相关系数的MLE分析（DeGroot和Goel,1980).

​      接下来，使用线性回归作为案例，我们在第2.4节中考虑无偏回归估计，条件是可用的比较数据，并将其与现有的频繁方法（例如，Lahiri和Larsen, 2005）。本文概述了一种适用于常见的概率性和确定性记录链接过程的比较数据建模方法，并讨论了C-PR案例中的可扩展性问题。我们发现，对于这种重量级的数据集，旨在使用所有记录的有效分析是极其不切实际的。

​      第三种方法包括仅利用具有几乎零 FLR的链路，以及基于所产生的链路子集针对剩余的错误链路和缺失的真匹配来调整所述分析。虽然这显然会导致效率的损失，但在诸如C-PR链接，其中仍然可以获得大的精确数据集，例如在估计的FLR大约为一万分之一的情况下，从第一次通过获得3000万条记录。当所有链路都是真匹配时，调整问题就变成了数据丢失问题。虽然对缺失数据的分析本身就是一个具有挑战性的问题，但使用可扩展到大型数据集的重权重和估算方法的传统由来已久。我们在第2.5节中说明了无偏链接子集回归的条件是如何发展的，然后是对面值回归分析进行简单的渐进调整，与允许在存在缺失数据的情况下基于观察数据进行分析的假设类似。

### 2.2联动数据结构

​       用于记录链接的独立数据集的链接数据结构将该问题与数据丢失或测量错误的问题区分开来。在后一种情况下，分析单位周围没有歧义，但是与单位相关的值可以观察到有误差或没有误差完全被观察到了。通常，可以合理地假设随机测量误差或缺失指标在一个单元与另一个单元之间是独立的，或者在一些已识别的单元簇之间是独立的。然而，在记录链接中，记录是否链接到另一条记录，或链接到哪条记录，必要地影响其他记录的链接方式，但注意力被限制在每个可链接记录集块内时也是如此。记录的不同配对会导致结果分析的不确定性，即使所有相关结果值都被视为固定值。一个关键问题是如何适当地适应这种相互依赖单元模糊性，而不是控制与识别单元相关的输出变量的随机机制。由于链接数据结构，没有明确说明这种相互依赖性的任何建模方法可能难以从一般意义上证明其合理性。此外，与实现相关的一个问题是如何处理两个或多个记录集之间的这种相互依赖所必需的组合学。

#### 2.2.1 定义

现在，我们提供两个独立数据集基础上的链接是数据结构正式描述。该定义可以很容易地推广到涉及三个或更多数据集的情况。分别用大小为
$$
n_A和n_B
$$
的A和B表示单独的数据集。用
$$
a\in A
$$
表示A中的任意记录，类似于
$$
b\in B
$$


如果是任意固定整数，则表示
$$
a\in A
$$


所指的真实实体。

如果
$$
i_a = i_b
$$
则对于
$$
a \in A
$$
和
$$
b \in B
$$
则记录对（ab)被称为匹配，在这种情况下，a和b都被称为A和B之间的匹配记录。如果对于所有的
$$
b\in B有i_a\neq i_b
$$
则a是不匹配的记录。类似地，对于B中的b。我们应该参考
$$
{\Lambda}_{AB} = \{i_a;a\in A\}\cup\{i_b;b\in B\}
$$
作为A和B之间的链接数据结构，除非存在允许精确匹配的唯一标识符，否则链接数据结构是未知的。A和B之间记录链接的结构可以看作是一个估计的链接数据结构，表示为
$$
{\widehat\Lambda}_{AB}=\{\widehat i_a;a\in A\}\cup\{\widehat i_b;b\in B\}
$$
其中
$$
\widehat i_a = \widehat i_b
$$
提供（ab)是一对链接记录。

​      当只有两个数据集A和B时，链接数据结构可以由
$$
n_A \times n_B
$$
匹配矩阵
$$
\omega
$$
表示

其中
$$
{\omega}_{ij}=1
$$
如果在A中的第i个记录和B中的第j个记录是一对匹配，否则

***因为下文中有很多字母和字符，所以从下文开始中文和字母字符都在$$里面写，除标题外其他默认居中对齐***


$$
{\omega}_{ij}=
$$

$$
我们假设已删除重复记录，因为{\sum}_j{\omega}_{ij}\leq 1 和{\sum}_i{\omega}_{ij}\leq 1，用\Omega表示匹配矩阵空间，这个空间包含了所有可能的\omega。由于每个不同的\omega\\对应于不同的链路数据结构{\Lambda}_{AB},如果i_a和i_b的值不相关，则空间\Omega有效地定义了链接数据结构的空间。
$$

$$
设\omega 是任意记录对（ab）的匹配指示符。设M(\omega)=\{(ab);{\omega}_{ab}=1,a\in A，b\in B\}是A和B之间的\\匹配集合。设\cup_A(\omega)是A中不匹配记录的集合，\cup_B(\omega)是B中不匹配记录的集合。在没有重复记录的情况下，对应于\omega的子矩阵\\是置换矩阵,其可以由单位矩阵的列（或行）的置换给出。这是匹配矩阵表示的一个有用属性。设 \widehat\omega=\omega_L是链接矩阵，\\其中如果(ab)是一对链接记录，则{\omega}_{L,ab}=1,否则\omega = 0。设A_L由来自A的链接记录组成，B_L由来自B的链接记录组成。\\记录链接可视为M，\cup_A和\cup_B的产量估计，其中\widehat M=M(\omega_L)=\{(ab);\omega_{L,ab}=1,a\in A_L,b\in B_L\},\\并且各自有\widehat \cup_A=A或者A_L和\widehat \cup_B = B或者B_L。\\
$$

$$
我们通常观察到的链接和匹配之间的术语上的明显区别：匹配（ab)意味着\omega_{ab}=1并且事实上i_a=i_b\\一个链接(ab)意味着\widehat \omega_{ab}=\omega_{L,ab}=1,可能匹配也可能不匹配。
$$

$$
用\delta_{ab}表示a\in A和b\in B 之间单独比较数据，供二级分析员使用。设G为可用\delta_{ab}的集合。为了区分，\\让\delta_{a}^*和\delta_{b}^*是执行记录链接的数据提供者可访问的完全比较数据。在C-PR链接中，\delta_a^*包含\\年龄、性别、姓名、出生日期、邮政编码等。不是所有的这些都会被释放。事实上，即使其中一些因素，\\例如年龄和性别，也很可能不会被指定为关键变量。
$$

$$
作为可用比较数据的可能示例，\delta_{ab}可以是总结a如何与b进行绝对或相对比较的值。特别的，如果a和b\\被认为彼此一致，则一致指示符由\delta_{ab}=1给出，否则由\delta_ab=0给出。链路指示器，其中\delta_{ab}=1,当且仅当\omega_{L,ab}=1,可视为特殊协议指示符，\\不仅涉及A和B之间的比较，还涉及是否将它们联系起来的决定。例如，从表2.1的确定性通过，如果a和b在所有相关关键变量方面\\彼此相等，则可以设置一致指示符\delta_{ab}=1。其中\delta_{ab}=1和\delta_{ab'}=1也许会出现，尽管b\neq b'\in B。然而，如果\delta_{ab}是来自相同通道的指示符，\\则通常不允许b=b'的\delta_{ab}=\delta_{ab'}=1,因此\delta_{ab}=1现在表示唯一一致。
$$

$$
作为最小可用比较数据的场景，让辅助分析仅给定链接数据集，但是没有任何无链接记录，G将会是\\链接矩阵\omega_L的数量，而不是其他。
$$

#### 2.2.2 匹配空间的协议划分

$$
随着数据集大小的增加，匹配空间\Omega的完整枚举很快失去控制。为了便于有效的部分枚举，可以引入\Omega 的合理划分，\\并且在某些假设的统计模型下仅处理其中\omega 最可能的子空间。下面我们描述\Omega的一致分割，并考虑它的一些含义。
$$

$$
在不失一般性的情况下，设D为由第二分析员基于可用比较数据G定义的一致矩阵，其中D_{ab}=1,\\
如果记录a\in A与b\in B'一致',否则D=0。例如，我们有D_{n\times n}=\omega_L提供的最小信息，\\其中n=|A_L|=|B_L|。或者，如果另外提供了A和B未链接的记录，则可以使\\D_{n\times n}=\omega_L。如果Fellegi-Sunter(FS)范式（Fellegi和Sunter，1969)下\\提供来自概率记录链接的权重\lambda_{ab}，则可以将一致性定义为如果\lambda_{ab}超过某个阈值的情况。
$$

$$
设\kappa = {\sum}_i{\sum}_jD_{ij}是D中的总协议数。对任意的\omega \in \Omega,设d = {\sum}_a{\sum}_bD_{ab}\omega_{ab}是匹配协议数，\\其中(\omega_{ab},D_{ab})=(1,1),即，根据\omega匹配且根据D彼此一致的记录的编号对。例如，假设D_{n\times n}和一一匹配\\,因此，每个\omega必然是一个置换矩阵，我们还需要附加的(\omega_{ab},D_{ab})=(1,0)的n-d记录对，\\(\omega_{ab},D_{ab})=(0,1)的k-d记录对，以及(\omega_{ab},D_{ab})=(0,0)的n^2-n-(k-d)记录对。
$$

$$
设\Omega_0是达到最大值的d的集合，用d_0表示。\Omega_0中的矩阵被称为最一致匹配矩阵（MAMM_s)。\\例如，在一一链接和一一匹配下，其中D也是置换矩阵，并且\kappa=n,只有一个d_0=n的MAMM，\\即，\omega=D。更一般地，在一一链接下，D可以是一个具有\kappa\geq n。只要D允许，一个一一链接的\\MAMM可以有(\omega_{ab},D_{ab})=(1,1)中的n个元素,(\omega_{ab},D_{ab})=(1,0)中的0个元素，\\(\omega_{ab},D_{ab})=(0,1)中的\kappa-n个元素，以及(\omega_{ab},D_{ab})=(0,0)中的n^2-\kappa个元素。
$$

$$
只要这样的矩阵存在，设\Omega_1包含被d_0-1给出的所有带有协同协定的\omega s。这不一定总是可能。\\例如，在一一链接和意义匹配的情况下，D和a之间的下一个最高可能的一致数是n-2,而不是n-1，\\因此，我们有\Omega_1 = \phi。设\Omega_k是d_0-k给出的符合数的匹配矩阵集。\Omega的协议分割由下式给出：
$$

$$
\Omega(D)=\cup_{k=0}^{d_0}\Omega_k
$$

$$
如果对记录链接程序由一定的信心，那么实践中的任何建模方法都会使得\omega的可能性在\Omega的一致性\\分割上随k而减小，这似乎是很自然的。事实上，在最小比较数据的情况下，其中D=G=\omega_L,\\二级分析员将不会有信息对来自相同\Omega_k的\omega放置不同的可能性。此外，设\omega\in \Omega_k\\和\omega'\in \Omega_{k+1},使得它们仅在一对(ab)中不同，其中D_{ab}=1,\omega_{ab}=1，\\但是\omega_{ab}’=0。两者之间基于D的似然比由下式给出：
$$

$$
LR(\omega',\omega;D)=\frac{L(\omega';D)}{L(\omega;D)} = \frac {Pr(D|D_ab=1;\omega')} {Pr(D|D_ab=1;\omega)}·\frac{Pr(D_{ab}=1;\omega')}{Pr(D_{ab}=1;\omega)}
$$

$$
既然现在\omega和\omega'在除(ab)之外的任何地方都是一致的，那么最简单的建模方法可以假设
$$

$$
LR(\omega',\omega;D)=\frac{Pr(D_{ab}=1;\omega_{ab}'=0)}{Pr(D_{ab}=1;\omega_{ab}=1)}
$$

显然，作为二次分析的最低可行性要求，必须提供某些链接准数据，已便能够对该比率建模，从而建立尊重链接数据结构的方法。
## 以下内容刘奕彤编写
### 2.4.3 比较数据建模(Ⅰ)

首先考虑一种比较数据建模的方法，它可以与FS范式下的概率记录联系起来。在保持普遍性的同时，让$g_a^*=h$作为$a \in A$的完整比较数据，同时$g_b^*=j$作为$b \in B$的完整比较数据，对于h,j=1,…,K 。正如Stoerts et al.（2015）等人，我们假定比较数据的潜在失真在实体之间是独立的，因此
$f(G^*|ω)= \prod\limits_{(ab) \in M}f(g_a^*,g_b^*|ω_ab=1) \prod\limits_{a \in U_B}f(g_a^*|a \in U_A) \prod\limits_{b \in U_B}f(g_b^*|b \in U_B)$

请注意，原则上，数据链接者可以提供这些概率作为比较数据，而不用披露关键变量。
当只有比较数据$G=\{g_{ab};a \in A_L,b \in B_L\}$ \\可用时，也就是实践中最有可能出现的情况，此时，可以从整合出$g_a^*$和$g_b^*$在完整的比较数据模型中的$g_a^*$和$g_b^*$进行积分，从而得到:

$f(G|\omega )= \prod\limits_{(ab):\omega_ab=1}f(g_ab|\omega_ab=1)$(2.3)

为了建立相关的概率模型，考虑Copas和Hilton（1990）提出的命中-失误失真模型模型，该模型由Copas和Hilton（1990）提出。设想一个二进制试验导致概率为$\alpha$的失误，随后观察到的值h是以概率$p_h$随机分布的，其中$p_h$是真实值h的频率。让$K=n_A +n_B-m$是A和B中实体的数量，其中$m=|M|$。假设所有实体的完整比较数据是不同的，因此以便$p_h=1/K$。对于一个简单的比较数据模型，让为协议指标。我们有:

$\mu_{ab}=f(g_{ab}=1|\omega_{ab}=1)=(1-\alpha)^2+2\alpha(1-\alpha)/K+\alpha^2/K$

$\mu_{ab}^c=f(g_{ab}=0|\omega_{ab}=1)=1-\mu_{ab}=(1-(1-\alpha)^2)(1-1/K)$

这可能被称为可交换协议（EA）模式。次要的分析师只需要提供K（或m）的估计值。

似乎很直观的是，在适当的条件下，EA模型可以产生ELE模型。适当的条件下，EA模型可以产生ELE模型。例如，假设一对一完全匹配，其中综合数据的分析h,j = 1,……,n 和$U_A = U_B =∅ $。在 EA 模型下，让$ \mu_ab=\mu(\alpha)$，其中$ g_{ab}$是协议指标。假设记录连接进行如下进程：如果它们是唯一一致的，则链接(ab)；如果没有唯一一致的记录，则随机链接记录中随机链接，但要遵守一对一的链接约束。这将导致ELE模型，其参数为$\lambda(\alpha,\phi)=q_{ii}=f(P_{ii}=1|\omega_{ii}=1)$, 其中$\omega=I_{n \times n}$的定义。

| $\alpha$ | n=3


| n=10 | n=50        | n=300       | n=1000      |             |             |
| ---- | ----------- | ----------- | ----------- | ----------- | ----------- |
| 0.02 | 0.974/0.987 | 0.965/0.981 | 0.961/0.975 | 0.961/0.964 | 0.960/0.962 |
| 0.05 | 0.935/0.966 | 0.912/0.950 | 0.904/0.925 | 0.903/0.910 | 0.903/0.907 |
| 0.10 | 0.873/0.937 | 0.829/0.895 | 0.814/0.846 | 0.811/0.827 | 0.810/0.824 |
| 0.20 | 0.760/0.878 | 0.676/0.790 | 0.647/0.712 | 0.641/0.691 | 0.640/0.688 |

虽然$\mu(\alpha)$有一个封闭的表达式，但$\lambda(\alpha,\phi)$只能通过G的蒙特卡洛模拟和随后的联系程序获得$\phi$。表2.2提供了$\mu$和$\lambda$给定的$\alpha$和n之间的比率，其中每个都是基于5000次模拟的结果。显然，在所有情况下$\mu /\lambda<1$。在一端，观察在任何固定的情况下，$\mu /\lambda→1$为$n\longrightarrow\infty$，因为在失误之后达成一致的机会趋于零，同时也趋于零。错过的机会趋向于零，而通过随机连接匹配的机会也是如此。在另一端，对于较小的n和较大的 ，$\mu /\lambda$进一步远离1，其中在这里，一对一联系限制的效果直观上是最强的。

表2.3

对于比较模型下的线性回归的一个非常简单的说明模型（2.3）下的线性回归，假设n=3的一对一完全匹配。矩阵$Q_G$为$\beta_G$由（2.2）取决于观察到的G。表2.3给出了两个例子。
$\alpha=0.02$时，观察到$G_1$的概率$f（G_1|\omega）$是0.923$G_1$，鉴于此
$\beta_G$的效率几乎与已知的$\omega$一样，因为$Q_G \approx I$ 。当$\alpha =0.1$观察到$G_1$的概率下降到0.666。回归的有效性低于$G=G_2$，从相应的$Q_G$可以看出。差异根植于$f(G|\omega)=\mu^{d}(1-\mu)^{n-d}$ 其中是观察到的$M(\mu)$的吻合度。让$d_0(G)$为给定G下最大可能的d，当$d_0(G_1)=3$且$d_0(G_2)=2$事，我们有：

$\sum_{\omega\in\Omega}f(G|\omega)=\sum_{d=0}^{d_{0}(G)}m_{d}f_{d}$

其中$f_d=f(G|\omega)$对于任何具有相同d的$\omega$来说是相同的，$m_d$是这样的数量$\omega's$. 似然比为$f_{d+1}/fd=\mu/(1-\mu)$.由$G_1$引起的协议分区是$m_d=(2,3,1)$，对于d=(0,1,3)，并且$\omega=G_1$的可能性是$f_3$,是次高的$f_1$的$\mu^2/(1-\mu)^2$倍。而鉴于$G_2$，我们有$m_d=(2,2,2)$，因为$d=(0,1,2)$，其中有两个$\omega's$最高的可能性$f_2$，是次高$f_1$的$\mu/(1-\mu)$倍。观察到$G=G_2$的不确定性显然大于$G=G_1$。

### 2.4.3 比较数据建模(Ⅱ)

在实践中，多通道的确定性联系是很常见的。让$L_k = A_k\times B_k$包含
k=1,…,K的第k次传递的$n_k$个链接。这些是在第k次传递中彼此完全一致的记录。没有链接的的记录留待以后的检验。让$A_0$包含A和$B_0$中的记录。联系的结果是分区:

$A\times B=\bigcup_{k=0}^{K}\bigcup_{j=0}^{K}A_{k}\times B_{j}$

让$g_{ab} = (k, j)$表示记录对(ab)属于分区的这些域的集合构成了比较数据G。

对于任何$（ab）\in  L_k$，让$\pi_{k}=\,f\bigl(\omega_{a b}\,=\,1\vert g_{a b}\,=\,(k,k)\bigr)$，这样，$1-\pi_{k}$   是$L_k$中的FLR（如表2.1）。我们有

$\mu_{a b}=f{\big(}g_{a b}=(k,k)|\omega_{a b}=1{\big)}=\pi_{k}f{\big(}g_{a b}=(k,k){\big)}/f(\omega_{a b}=1)$

人们可以通过$\pi_k n_k/m$来估计$\mu_{ab}$。理想情况下，我们希望数据提供者
能够提供$\mu_{a b}=\,f\bigl(g_{a b}=(k,j)\bigr)\bigl\vert\omega_{a b}=\,1\,\bigr)$对所有其他的组合

(k, j)也是如此。然而，这在实践中可能是很苛刻的。作为一个可能的
简化，让$L=\bigcup_{k=1}^{K}L_{k}$包含所有的链接对，并让

$\mu_{a b}=f\Bigl((a b)\ll L|\omega_{a b}=1\Bigr)=1-\sum_{k=1}^{K}f\Bigl(g_{a b}=(k,k)|\omega_{a b}=1\Bigr)$

其中假定$g_{ab}$在连接对之外的均匀分布。

当然，上述比较模型是对现实的极大简化。
因为匹配不可能均匀地分布在
$R = (A\times B) / L$。事实上，在所有未链接的记录对中，我们可以期待
预计$m_{R}=m-\sum_{k=1}^{K}\pi_{k}n_{k}$的匹配。我们可以探索$\mu_{ab}$的界限.例如，让$R_k$成为R的子集，其中涉及$a \in A_k$或$b \in B_k$，在这里我们最多可以期待$2n_{k} 1-\pi_{k})$匹配。因此，

$ f{\bigl(}(a b)\in R_{k}{\vert}\omega_{a b}=1{\bigr)}\leq2(1-\pi_{k})n_{k}/mf$，这就提供了一个$\mu_{ab}$在$R_k$上的上限.此外，让$R_0=A_0 \times B_0$，其中可以预期至少有

$m_{R}-2\sum_{k=1}^{K}(1-\pi_{k})n_{k}$k的匹配，因此$\mu_{ab}$在$R_0$上的下限是

$R_{0}|\omega_{a b}=1\rangle\geq1-\sum_{k=1}^{K}(2-\pi_{k})n_{k}/m$

让我们考虑C-PR的情况来说明。让$n_A$是人口普查数据集的大小，$n_B$是病人登记册的大小。让$n_L$是链接的数量（表2.1），m为匹配实体的数量。为了便于理解，假设m=51，nA=53，nB=55，都是以百万计。

* 对于第k个确定性通道，其中k=1,…9，FLR $1 -\pi_k$给出如表2.1我们设定  $\mu_{ab} = \pi_k n_k/m$ 为$（ab）\in  L_k$。

- 除了表2.1之外，我们没有其他关于两个概率性，分别用$L_10$和$L_11$表示。因此我们把它们就像从确定的联系中产生的一样。
- 我们还计算了$R_k$中的上界概率$\mu_{ab}$，和$R_0$中的下限概率 ˜$\mu_{ab}$。

表2.4

当涉及到大型人口时，可扩展性是一个重要的问题，比如在C-PR案例中。考虑一下评估的一般任务：

$E(t_{\omega}|G)=\sum_{\Omega}t_{\omega}f(\omega|G)=\sum_{\Omega}t_{\omega}f(G|\omega)/\sum_{\Omega}f(G|\omega)$

此时$t_\omega$ 是$\omega$的一个函数，正如在2.2中作为$Q_G$的$t_\omega=\omega^T$

完整列举$\omega$在大多数情况下是不可行的。让我们从$\omega$
中去一个样本$ s=\{\omega_{1},...,\omega_{n_{\circ}}\}\subset\Omega$.如果对$\omega's$进行随机抽样，那么H´ajek类型的估计是$E(t_\omega|G)$是$\bar{t}_{H}:=\sum\omega{\in}s\,t_{\omega}f(G|_{c o})/{\sum}\omega{\in}s\,f(G|_{c o})$而如果$\omega\sim f(\omega|G)$,蒙特卡洛估计是$\bar{t}=\sum_{\omega\in s}t_{\omega}/n_{s}$ 。Metropolis-Hastings算法提供了一种解决后者的一般方法：在每一步中从当前的中提出一个新的$\omega's$，其中的提议是对称的，接受率为$min|\{1,\;f(\omega^{\prime}|G)/f(\omega|G)\}.$

在上面的比较数据模型下，我们可以直接分析C-PR联系数据的接受率。让$\omega=\omega_L$ 为与链接矩阵完全一致的匹配矩阵，其中当且仅当$(ab) \in L $时$\omega_{ab}=1$。在以下子矩阵中得到了一般性的描述$\{a,a^{\prime},a^{\prime\prime}\}\times\{b,b^{\prime},b^{\prime\prime}\}$:

$[\omega_{L}]=\left[\begin{array}{c c c}{{1}}&{{0}}&{{0}}\\ {{0}}&{{1}}&{{0}}\\ {{0}}&{{0}}&{{0}}\end{array}\right]$

$[\omega_{1}]=\left[\begin{array}{c c c}{{1}}&{{0}}&{{0}}\\ {{0}}&{{1}}&{{0}}\\ {{0}}&{{0}}&{{1}}\end{array}\right]$

$[\omega_{2}]=\left[\begin{array}{c c c}{{0}}&{{0}}&{{1}}\\ {{0}}&{{1}}&{{0}}\\ {{0}}&{{0}}&{{0}}\end{array}\right]$

$[\omega_{3}]=\left[\begin{array}{c c c}{{0}}&{{1}}&{{0}}\\ {{1}}&{{0}}&{{0}}\\ {{0}}&{{0}}&{{0}}\end{array}\right]$

其中$1\leq k\neq k^{\prime}\leq11$ $(ab) \in L_K$

每一矩阵中的第一行是子向量$(\omega_{a b},\omega_{a b^{\prime}},\alpha_{a b^{\prime\prime}})$，第二行和第三行也是如此.

* $\omega_L$和$\omega_1$之间的唯一区别是，$\omega_1$包含一个额外的匹配 (a'',b'')。根据表2.4,我们有$f(\omega_{1}|G)/f(\omega_{L}|G)=\mu_{a b;0}=0.0100,$，或者至少是0.0055.
* 根据$\omega_2$，$R_k$中的一对实际上是一个匹配，而不是$L_k$中的一对。有$f(\omega_{2}|G)/f(\omega_{L}|G)=f{\big(}(a b^{\prime\prime})\in R_{k}|\omega_{a b^{\prime}}=1{\big)}/\mu_{a b;k}\leq{\tilde{\mu}}_{a b;k}/\mu_{a b;k}$，这对于表2.4中的所有1＜k＜ 11接近于零。
* 对于$\omega_3$，$L_k$中的(ab)和$L_{k'}$中的(a',b')是错误的链接，而$R_k$中的(ab')和(a'b)匹配未能被链接。而$R_k$中的(ab')和$R_{k'}$中的(a'b)不能被链接。我们有$f(\omega_{3}|G)/f(\omega_{L}|G)\ \leq\tilde{\mu}_{a b;k}\tilde{\mu}_{a b;k^{\prime}}/\mu_{a b;k}\mu_{a b;k^{\prime}}$这对所有$1\leq k\mp k^{\prime}\leq1^{\circ}$来说几乎是零。

因此，Metropolis-Hastings算法在数值上是不够有效的。考虑到$m>n_L$，匹配矩阵有$\omega_L$ 作为链接记录的子矩阵，再加上$m-n_L$在$A_0 \times B_0$之间的额外匹配,都有相同的可能性。这种矩阵的数量是$\left((n_{A}-n_{L})!/(n_{A}-m)!\right)\Bigl((n_{B}-n_{L})!/(n_{B}-m)!\Bigr)/(m-n_{L})!$

在结果空间如此之大的情况下，任何对$f(\omega|G)$的再抽样方法都是非常不切实际的。

